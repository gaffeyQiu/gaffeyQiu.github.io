<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='进程间通信 （Inter Process Communication） 竞争条件（race condition） 前提 书中举了一个脱机打印程序的例子，当一个进程需要打印一个文件，它将需要打印的文件名放在一个特殊的目录下（脱机目录），另一个进程则周期性的检查是否有文件需要打印，如果有就打印这个文件并将文件名从这个目录下删掉。
假设这个目录下有很多格子，每个格子可以放一个文件名，还有两个共享变量 in 和 out out 指向下一个要打印的文件名，in 指向目录中下一个空闲的格子。这两个变量能同时被这两个进程访问到。
场景   在某一时刻， 4～6 号格子被需要打印的文件名占用。 在同一时刻，进程A 和 进程B 都决定要打印一个文件，会发生的可能情况：
A 读到 in 的值为 7，然后将 7 存在自己进程的一个变量中 next_free_slot, 此时发生一次时钟中断，CPU 切换到 B，进程 B 也读到 in 的值为 7，同样存放到自己进程变量 next_free_slot 中，结果这两个进程都认为下一个可用格子为 7， B 接着运行，它将需要打印的文件名写入 7 号格子中，并更新 in 的值为 8，然后进程B执行结束，换到 进程A 从上次中断的地方执行， A 检查自己的 next_free_slot 为 7，于是把文件名写入到 7 号格子中，修改 in 的值为 8， 出现的结果就是 进程B 需要打印的文件名被覆盖掉， 导致进程B需要打印的文件不会被打印机打印， 程序也不会发生任何错误。
类似这样的情况， 称为 竞争条件（race condition）'><title>进程间通信（Inter Process Communication）</title>

<link rel='canonical' href='https://blog.7bao.fun/p/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1inter-process-communication/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='进程间通信（Inter Process Communication）'>
<meta property='og:description' content='进程间通信 （Inter Process Communication） 竞争条件（race condition） 前提 书中举了一个脱机打印程序的例子，当一个进程需要打印一个文件，它将需要打印的文件名放在一个特殊的目录下（脱机目录），另一个进程则周期性的检查是否有文件需要打印，如果有就打印这个文件并将文件名从这个目录下删掉。
假设这个目录下有很多格子，每个格子可以放一个文件名，还有两个共享变量 in 和 out out 指向下一个要打印的文件名，in 指向目录中下一个空闲的格子。这两个变量能同时被这两个进程访问到。
场景   在某一时刻， 4～6 号格子被需要打印的文件名占用。 在同一时刻，进程A 和 进程B 都决定要打印一个文件，会发生的可能情况：
A 读到 in 的值为 7，然后将 7 存在自己进程的一个变量中 next_free_slot, 此时发生一次时钟中断，CPU 切换到 B，进程 B 也读到 in 的值为 7，同样存放到自己进程变量 next_free_slot 中，结果这两个进程都认为下一个可用格子为 7， B 接着运行，它将需要打印的文件名写入 7 号格子中，并更新 in 的值为 8，然后进程B执行结束，换到 进程A 从上次中断的地方执行， A 检查自己的 next_free_slot 为 7，于是把文件名写入到 7 号格子中，修改 in 的值为 8， 出现的结果就是 进程B 需要打印的文件名被覆盖掉， 导致进程B需要打印的文件不会被打印机打印， 程序也不会发生任何错误。
类似这样的情况， 称为 竞争条件（race condition）'>
<meta property='og:url' content='https://blog.7bao.fun/p/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1inter-process-communication/'>
<meta property='og:site_name' content='gaffey的开发日志'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='OS' /><meta property='article:tag' content='操作系统' /><meta property='article:published_time' content='2022-02-24T10:00:41&#43;08:00'/><meta property='article:modified_time' content='2022-02-24T10:00:41&#43;08:00'/><meta property='og:image' content='https://ypy.7bao.fun/img/20220224103519.png' />
<meta name="twitter:title" content="进程间通信（Inter Process Communication）">
<meta name="twitter:description" content="进程间通信 （Inter Process Communication） 竞争条件（race condition） 前提 书中举了一个脱机打印程序的例子，当一个进程需要打印一个文件，它将需要打印的文件名放在一个特殊的目录下（脱机目录），另一个进程则周期性的检查是否有文件需要打印，如果有就打印这个文件并将文件名从这个目录下删掉。
假设这个目录下有很多格子，每个格子可以放一个文件名，还有两个共享变量 in 和 out out 指向下一个要打印的文件名，in 指向目录中下一个空闲的格子。这两个变量能同时被这两个进程访问到。
场景   在某一时刻， 4～6 号格子被需要打印的文件名占用。 在同一时刻，进程A 和 进程B 都决定要打印一个文件，会发生的可能情况：
A 读到 in 的值为 7，然后将 7 存在自己进程的一个变量中 next_free_slot, 此时发生一次时钟中断，CPU 切换到 B，进程 B 也读到 in 的值为 7，同样存放到自己进程变量 next_free_slot 中，结果这两个进程都认为下一个可用格子为 7， B 接着运行，它将需要打印的文件名写入 7 号格子中，并更新 in 的值为 8，然后进程B执行结束，换到 进程A 从上次中断的地方执行， A 检查自己的 next_free_slot 为 7，于是把文件名写入到 7 号格子中，修改 in 的值为 8， 出现的结果就是 进程B 需要打印的文件名被覆盖掉， 导致进程B需要打印的文件不会被打印机打印， 程序也不会发生任何错误。
类似这样的情况， 称为 竞争条件（race condition）"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://ypy.7bao.fun/img/20220224103519.png' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1inter-process-communication/">
                
                    <img src="https://ypy.7bao.fun/img/20220224103519.png" loading="lazy" alt="Featured image of post 进程间通信（Inter Process Communication）" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/os/" style="background-color: #2a9d8f; color: #fff;">
                OS
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1inter-process-communication/">进程间通信（Inter Process Communication）</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 24, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    2 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h1 id="进程间通信-inter-process-communication">进程间通信 （Inter Process Communication）</h1>
<h2 id="竞争条件race-condition">竞争条件（race condition）</h2>
<h4 id="前提">前提</h4>
<p>书中举了一个脱机打印程序的例子，当一个进程需要打印一个文件，它将需要打印的文件名放在一个特殊的目录下（脱机目录），另一个进程则周期性的检查是否有文件需要打印，如果有就打印这个文件并将文件名从这个目录下删掉。</p>
<p>假设这个目录下有很多格子，每个格子可以放一个文件名，还有两个共享变量 in 和 out
out 指向下一个要打印的文件名，in 指向目录中下一个空闲的格子。这两个变量能同时被这两个进程访问到。</p>
<h4 id="场景">场景</h4>
<p><figure 
	>
	<a href="https://ypy.7bao.fun/img/20220222163158.png" >
		<img src="https://ypy.7bao.fun/img/20220222163158.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure>
在某一时刻， 4～6 号格子被需要打印的文件名占用。 在同一时刻，进程A 和 进程B 都决定要打印一个文件，会发生的可能情况：</p>
<p>A 读到 in 的值为 7，然后将 7 存在自己进程的一个变量中 next_free_slot, 此时发生一次时钟中断，CPU 切换到 B，进程 B 也读到 in 的值为 7，同样存放到自己进程变量 next_free_slot 中，结果这两个进程都认为下一个可用格子为 7， B 接着运行，它将需要打印的文件名写入 7 号格子中，并更新 in 的值为 8，然后进程B执行结束，换到 进程A 从上次中断的地方执行， A 检查自己的 next_free_slot 为 7，于是把文件名写入到 7 号格子中，修改 in 的值为 8， 出现的结果就是 进程B 需要打印的文件名被覆盖掉， 导致进程B需要打印的文件不会被打印机打印， 程序也不会发生任何错误。</p>
<p>类似这样的情况， 称为 <strong>竞争条件（race condition）</strong></p>
<h2 id="临界区">临界区</h2>
<p>凡涉及共享内存、共享文件以及共享任何资源的情况都会引发与前面类似的错误， 要避 免这种错误 。
我们把对共享内存进行访问的程序片段称作 <strong>临界区域（critical region）</strong> 或 <strong>临界区（critical section）</strong>。</p>
<p>对于一个好的解决方案，需要满足以下4个条件：
1.任何两个进程不能同时处于其临界区.
2.不应对CPU的速度和数量做任何假设。
3.临界区外运行的进程不得阻塞其他进程。
4.不得使进程无限期等待进入临界区。</p>
<p><figure 
	>
	<a href="https://ypy.7bao.fun/img/20220222164643.png" >
		<img src="https://ypy.7bao.fun/img/20220222164643.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<h2 id="忙等待的互斥">忙等待的互斥</h2>
<h3 id="1-屏蔽中断">1. 屏蔽中断</h3>
<p>在单核处理器中，最简单直接的方法是程序进入临界区之前屏蔽掉所有中断，这样能保证程序在临界区内的操作不会被其他进程介入，然后离开临界区之后再恢复中断。
缺点： 把屏蔽中断权利交给用户进程是不明智的，假如用户进程屏蔽中断之后不再打开中断，系统会因此而终止。</p>
<h3 id="2-锁变量">2. 锁变量</h3>
<p>假设有一个共享变量A，初始值为 0， 当某个程序想进入临界区之前，获取到 A 的值为 0，代表可以进入临界区，修改 A 为 1，然后执行临界区操作，离开临界区再将 A 的值改为 0， 如果其他进程获取到 A 的值为1的时候，则等待 A = 0 之后再进入临界区。
缺点： 和脱机打印程序的例子一样，有可能两个程序读到相同的值。</p>
<h3 id="3-严格轮换法">3. 严格轮换法</h3>
<p>定义一个整形变量 turn，用于记录轮到哪个进程进入临界区，开始时由于 turn 初始值为0，所以进程0 可以进入临界区，进程1发现 turn 为0，所以不停循环检查 turn 的值何时为 1。</p>
<blockquote>
<p>这种不停测试变量直到某个值出现，成为忙等待，会浪费CPU时间，应该避免，只有认为等待时间非常短的情况下才可以使用，称为自旋锁（spin lock）</p>
</blockquote>
<p><figure 
	>
	<a href="https://ypy.7bao.fun/img/20220222173831.png" >
		<img src="https://ypy.7bao.fun/img/20220222173831.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>当进程0结束了非临界区的操作并回到最开始的循环，但是，这个时候它还不能进入临界区，因为进程1还在执行非临界区的操作，进程0只有等待进程1把 turn 的值改为0，这说明，在一个进程比另一个进程慢的情况下，轮流进入临界区并不是一个好办法。</p>
<h3 id="4-peterson-解法">4. Peterson 解法</h3>
<p><figure 
	>
	<a href="https://ypy.7bao.fun/img/20220222174430.png" >
		<img src="https://ypy.7bao.fun/img/20220222174430.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure>
进入临界区之前，每个进程调用 enter_region() 方法传入自己的进程号 0 或者1，该函数最后一段代码会进行忙等待，直到允许进入临界区，然后调用 leave_region() 方法离开临界区。
举一个例子：进程0和1都想进入临界区，他们同时调用了enter_region()， 现在全局变量 <code>interested[0] = TRUE， turn = 0</code>  ，然后被稍微后进入的进程1覆盖了这些变量 <code>interested[1] = TRUE， turn = 1</code>， 此时都执行到 while 语句， <code>turn == process &amp;&amp; interested[other] == TRUE</code>  此时进程1刚好满足这条语句，进入空循环，也就是忙等待， 进程0得以进入临界区，进程 0 执行完毕后将 <code>interested[0] = FALSE</code>, 然后进程1的这条判断不成立 <code>interested[other] == TRUE</code>, 进程1则可以正常进入临界区。
缺点：有忙等待调用</p>
<h3 id="5tsl指令">5.TSL指令</h3>
<pre tabindex="0"><code>TSL RX, LOCK
</code></pre><p>这是一种硬件支持的方案, 称为 <strong>测试并加锁</strong> ， 它是将一个字读到寄存器 RX 中，然后在该内存地址上存一个非0值，执行 TSL 指令的 CPU将锁住内存总线，禁止其他CPU在本指令结束之前访问内存
![[Pasted image 20220222180533.png]]</p>
<h2 id="同步原语">同步原语</h2>
<p>前面的解法都会有忙等待问题，浪费了大量的 CPU 时间。
所以同步原语会阻塞进程，而不是忙等待。</p>
<h4 id="信号量semaphore">信号量（semaphore）</h4>
<p>为了确保信号量能正确工作， 通常将 down 和  up（经常称为 P 和 V）作为系统调用实现，操作系统只需在执行信号量检测，更新信号量的时候屏蔽全部中断即可，而且由于这些动作只需要几条指令，不会有忙等待的副作用（操作系统也是借用 TSL 等硬件支持的指令来完成）</p>
<h4 id="互斥量mutex">互斥量（Mutex）</h4>
<p>互斥量是简化版本的信号量，它不需要计数能力，所以只需要一个二进制位表示。互斥量仅仅适用于管理共享资源或一小段代码。
当需要访问临界区资源时候，调用 mutex_lock , 离开临界区使用 mutex_unlock, 当其他进程同时想进入临界区调用 lock 方法时，会被阻塞，它将调用 thread_yield 将 CPU 放弃给另一个线程，直到再次轮到自己执行，才会检查锁。
由于 thread_yield 和 mutex 的 lock 和 unlock 方法都是用户空间中进行， 不需要进行系统调用，所以运行非常快。</p>
<h4 id="管程monitor-和-条件变量condition">管程（monitor） 和 条件变量（condition）</h4>
<p>引入了管程是为了将对共享资源的所有访问及其所需要的同步操作集中并封装起来。
管程相当于一个隔离区，它把共享变量和对它进行操作的若干个过程围了起来，所有进程要访问临界资源时，都必须经过管程才能进入，而管程每次只允许一个进程进入管程，从而需要确保进程之间互斥。
但在管程中仅仅有互斥操作是不够用的。进程可能需要等待某个条件Cond为真才能继续执行。如果采用忙等待方式：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">while</span> <span class="nf">not</span> <span class="p">(</span><span class="n">Cond</span><span class="p">)</span> <span class="k">do</span> <span class="p">{}</span>
</code></pre></div><p>在单处理器情况下，将会导致所有其它进程都无法进入临界区使得该条件Cond为真，该管程的执行将会发生死锁。
为此，可引入条件变量（Condition Variables，简称CV）。一个条件变量CV可理解为一个进程的等待队列，队列中的进程正等待某个条件Cond变为真。每个条件变量关联着一个条件，如果条件Cond不为真，则进程需要等待，如果条件Cond为真，则进程可以进一步在管程中执行。需要注意当一个进程等待一个条件变量CV（即等待Cond为真），该进程需要退出管程，这样才能让其它进程可以进入该管程执行，并进行相关操作，比如设置条件Cond为真，改变条件变量的状态，并唤醒等待在此条件变量CV上的进程。因此对条件变量CV有两种主要操作：</p>
<ul>
<li>wait_cv： 被一个进程调用，以等待断言Pc被满足后该进程可恢复执行. 进程挂在该条件变量上等待时，不被认为是占用了管程。</li>
<li>signal_cv：被一个进程调用，以指出断言Pc现在为真，从而可以唤醒等待断言Pc被满足的进程继续执行。</li>
</ul>
<h4 id="消息传递">消息传递</h4>
<h4 id="屏障-barrier">屏障 （barrier）</h4>
<p>规定当一个进程到达屏障时， 它就被屏障阻拦，直到所有进程都到达该屏障为止。屏障可用于一组进程同步
<figure 
	>
	<a href="https://ypy.7bao.fun/img/20220222203724.png" >
		<img src="https://ypy.7bao.fun/img/20220222203724.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<h4 id="避免锁读-复制-更新rcuread-copy-update">避免锁：读-复制-更新RCU(Read-Copy Update)</h4>
<p>最快的锁就是没有锁。
RCU是 Linux 中比较重要的一种同步机制。随意读，但更新数据的时候，需要先复制一份副本，在副本上完成修改，最后使用一个回调（callback）机制在适当的时机把指向原来数据的指针重新指向新的被修改的数据。这个时机就是所有引用该数据的CPU都退出对共享数据的操作</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/os/">OS</a>
        
            <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6/">
        
        
            <div class="article-image">
                
                    <img src="https://ypy.7bao.fun/img/20220224114114.png" loading="lazy" data-key="" data-hash="https://ypy.7bao.fun/img/20220224114114.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">进程调度</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-ucore-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/">
        
        
            <div class="article-image">
                
                    <img src="https://ypy.7bao.fun/img/xps-EzYq1HOl5_8-unsplash.jpg" loading="lazy" data-key="" data-hash="https://ypy.7bao.fun/img/xps-EzYq1HOl5_8-unsplash.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">[操作系统实验] ucore 环境准备</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <p><a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank">本网站由<img src="https://cdn.learnku.com/uploads/banners/XPtLlZmIN1cQbLuDFEON.png!large" width="100">CDN驱动</p>
    <section class="copyright">
        &copy; 
        
            2021 - 
        
        2022 gaffey的开发日志
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#竞争条件race-condition">竞争条件（race condition）</a>
      <ol>
        <li>
          <ol>
            <li><a href="#前提">前提</a></li>
            <li><a href="#场景">场景</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#临界区">临界区</a></li>
    <li><a href="#忙等待的互斥">忙等待的互斥</a>
      <ol>
        <li><a href="#1-屏蔽中断">1. 屏蔽中断</a></li>
        <li><a href="#2-锁变量">2. 锁变量</a></li>
        <li><a href="#3-严格轮换法">3. 严格轮换法</a></li>
        <li><a href="#4-peterson-解法">4. Peterson 解法</a></li>
        <li><a href="#5tsl指令">5.TSL指令</a></li>
      </ol>
    </li>
    <li><a href="#同步原语">同步原语</a>
      <ol>
        <li>
          <ol>
            <li><a href="#信号量semaphore">信号量（semaphore）</a></li>
            <li><a href="#互斥量mutex">互斥量（Mutex）</a></li>
            <li><a href="#管程monitor-和-条件变量condition">管程（monitor） 和 条件变量（condition）</a></li>
            <li><a href="#消息传递">消息传递</a></li>
            <li><a href="#屏障-barrier">屏障 （barrier）</a></li>
            <li><a href="#避免锁读-复制-更新rcuread-copy-update">避免锁：读-复制-更新RCU(Read-Copy Update)</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
